<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cement Production Planner</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

body {
font-family: 'Inter', sans-serif;
}

/* Product color coding */
.product-opc { background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); border-left: 4px solid #3b82f6; }
.product-il11 { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-left: 4px solid #f59e0b; }
.product-il8 { background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%); border-left: 4px solid #ec4899; }
.product-ppc { background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%); border-left: 4px solid #6366f1; }

.product-badge {
display: inline-block;
padding: 2px 8px;
border-radius: 12px;
font-size: 10px;
font-weight: 600;
text-transform: uppercase;
letter-spacing: 0.5px;
}

.badge-opc { background: #3b82f6; color: white; }
.badge-il11 { background: #f59e0b; color: white; }
.badge-il8 { background: #ec4899; color: white; }
.badge-ppc { background: #6366f1; color: white; }

.product-card {
transition: all 0.2s;
cursor: pointer;
}

.product-card:hover {
transform: translateY(-2px);
box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.product-card.selected {
border-color: #3b82f6;
box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.recipe-ingredient {
display: grid;
grid-template-columns: 200px 1fr 100px;
gap: 12px;
align-items: center;
padding: 12px;
background: #f9fafb;
border-radius: 6px;
margin-bottom: 8px;
}

.ingredient-slider {
width: 100%;
}

.modal {
display: none;
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: rgba(0,0,0,0.7);
z-index: 1000;
align-items: center;
justify-content: center;
}

.modal.active {
display: flex;
}

.calendar-day {
min-height: 80px;
border: 1px solid #e5e7eb;
padding: 4px;
cursor: pointer;
transition: all 0.2s;
}

.calendar-day:hover {
background: #f3f4f6;
border-color: #3b82f6;
}

.calendar-day.selected {
background: #dbeafe;
border-color: #3b82f6;
border-width: 2px;
}

.calendar-day.maintenance {
background: repeating-linear-gradient(45deg, #fef2f2, #fef2f2 10px, #fee2e2 10px, #fee2e2 20px);
}

.calendar-day.shutdown {
background: #f3f4f6;
}

/* Process Flow Styles */
.toolbar-item {
cursor: grab;
transition: all 0.2s;
}

.toolbar-item:hover {
transform: translateY(-2px);
box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.equipment-node {
cursor: move;
transition: all 0.2s;
}

.equipment-node:hover {
filter: drop-shadow(0 4px 12px rgba(0,0,0,0.3));
}

.equipment-node.selected {
filter: drop-shadow(0 0 12px #3b82f6);
}

.connection-line {
stroke: #9ca3af;
stroke-width: 3;
fill: none;
cursor: pointer;
}

.connection-line:hover {
stroke: #3b82f6;
stroke-width: 4;
}

.port {
cursor: crosshair;
transition: all 0.2s;
}

.port:hover {
r: 8;
fill: #3b82f6;
}

.hidden {
display: none;
}

/* Sticky scrollbar container - always visible at top */
.scrollbar-container {
position: sticky;
top: 60px; /* Below the sticky date header */
z-index: 15;
background: white;
border-bottom: 1px solid #e5e7eb;
overflow-x: scroll;
overflow-y: hidden;
height: 20px;
}

.scrollbar-container::-webkit-scrollbar {
height: 12px;
}

.scrollbar-container::-webkit-scrollbar-track {
background: #f1f5f9;
}

.scrollbar-container::-webkit-scrollbar-thumb {
background: #94a3b8;
border-radius: 6px;
}

.scrollbar-container::-webkit-scrollbar-thumb:hover {
background: #64748b;
}

/* Force scrollbar to always show */
.scrollbar-content {
height: 1px;
}
</style>
</head>
<body class="bg-gray-50">
<div id="app"></div>

<!-- Product Recipe Modal -->
<div id="recipeModal" class="modal">
<div class="bg-white rounded-lg p-6 w-full max-w-3xl border border-gray-200 shadow-2xl max-h-[90vh] overflow-y-auto">
<div class="flex items-center justify-between mb-4">
<h3 class="text-xl font-bold text-gray-900" id="recipeModalTitle">Edit Product Recipe</h3>
<button onclick="closeRecipeModal()" class="text-gray-400 hover:text-gray-600">
<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
</svg>
</button>
</div>
<div id="recipeModalContent"></div>
<div class="flex justify-end space-x-2 mt-6">
<button onclick="closeRecipeModal()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded">Cancel</button>
<button onclick="saveRecipe()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded">Save Recipe</button>
</div>
</div>
</div>

<!-- Production Day Modal -->
<div id="dayModal" class="modal">
<div class="bg-white rounded-lg p-6 w-full max-w-2xl border border-gray-200 shadow-2xl">
<div class="flex items-center justify-between mb-4">
<h3 class="text-xl font-bold text-gray-900" id="dayModalTitle">Edit Production Day</h3>
<button onclick="closeDayModal()" class="text-gray-400 hover:text-gray-600">
<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
</svg>
</button>
</div>
<div id="dayModalContent"></div>
<div class="flex justify-end space-x-2 mt-6">
<button onclick="closeDayModal()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded">Cancel</button>
<button onclick="saveDayPlan()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded">Save Changes</button>
</div>
</div>
</div>

<script>
console.log('=== CEMENT PLANNER STARTING ===');

// ============================================
// GLOBAL STATE
// ============================================

console.log('Initializing APP_STATE...');

        // ============================================
        // CEMEX FLORIDA REGION - LOCATIONS
        // ============================================
        const CEMEX_LOCATIONS = {
            'MIA': { code: 'MIA', name: 'Miami Plant',           type: 'plant',    icon: 'üè≠', color: '#1d4ed8', bg: '#eff6ff' },
            'BRS': { code: 'BRS', name: 'Brooksville Plant',     type: 'plant',    icon: 'üè≠', color: '#15803d', bg: '#f0fdf4' },
            'PEV': { code: 'PEV', name: 'Port Everglades',       type: 'terminal', icon: 'üö¢', color: '#0e7490', bg: '#ecfeff' },
            'WPB': { code: 'WPB', name: 'West Palm Beach',       type: 'terminal', icon: 'üö¢', color: '#0369a1', bg: '#f0f9ff' },
            'ORL': { code: 'ORL', name: 'Orlando Terminal',      type: 'terminal', icon: 'üöÇ', color: '#7c3aed', bg: '#f5f3ff' },
            'SUB': { code: 'SUB', name: 'Sutton Terminal',       type: 'terminal', icon: 'üöÇ', color: '#b45309', bg: '#fffbeb' },
            'JAX': { code: 'JAX', name: 'Jacksonville Terminal', type: 'terminal', icon: 'üöÇ', color: '#9f1239', bg: '#fff1f2' }
        };

const APP_STATE = {
currentTab: 'products',
            currentDate: new Date('2025-02-14'),
            currentDate: new Date(),
            currentLocation: localStorage.getItem('cemex_current_location') || 'MIA',

// Product Definitions
products: {
@@ -520,36 +534,69 @@
// ============================================

function renderHeader() {
            const loc = CEMEX_LOCATIONS[APP_STATE.currentLocation] || CEMEX_LOCATIONS['MIA'];
            const isPlant = loc.type === 'plant';
return `
                <div class="bg-white border-b border-gray-200 shadow-sm">
                    <div class="px-6 py-4">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-4">
                                <div class="bg-blue-600 text-white p-2 rounded-lg">
                                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
                                    </svg>
                                </div>
                                <div>
                                    <h1 class="text-2xl font-bold text-gray-900">Cement Production Planner</h1>
                                    <p class="text-sm text-gray-500">Configure ‚Üí Design ‚Üí Plan ‚Üí Monitor</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-3">
                                <div class="text-right mr-4">
                                    <div class="text-sm text-gray-500">Today</div>
                                    <div class="text-lg font-semibold text-gray-900">${APP_STATE.currentDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</div>
                                </div>
                                <button onclick="exportAllData()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                                    üì• Export All Data
                <div class="border-b border-gray-200 shadow-sm" style="background:white;">
                    <!-- TOP BAR: Location identifier & switcher -->
                    <div class="px-6 py-2 flex items-center justify-between" style="background:${loc.color}; color:white;">
                        <div class="flex items-center space-x-2 text-sm font-medium">
                            <span class="font-bold text-white text-base tracking-wide">CEMEX</span>
                            <span class="opacity-60">‚Ä∫</span>
                            <span class="opacity-90">Florida Region</span>
                            <span class="opacity-60">‚Ä∫</span>
                            <span class="font-bold">${loc.icon} ${loc.name}</span>
                            <span class="ml-2 px-2 py-0.5 rounded text-xs font-bold" style="background:rgba(255,255,255,0.25)">${loc.code}</span>
                            <span class="px-2 py-0.5 rounded text-xs" style="background:rgba(255,255,255,0.15)">${isPlant ? 'üè≠ Plant' : 'üì¶ Terminal'}</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="text-xs opacity-75">Switch:</span>
                            ${Object.values(CEMEX_LOCATIONS).map(l => `
                                <button onclick="switchLocation('${l.code}')"
                                        title="${l.name}"
                                        class="px-2 py-0.5 rounded text-xs font-bold transition-all ${l.code === APP_STATE.currentLocation
                                            ? 'bg-white text-gray-800 shadow'
                                            : 'text-white opacity-60 hover:opacity-100'
                                        }">
                                    ${l.icon} ${l.code}
                               </button>
                            `).join('')}
                        </div>
                    </div>
                    <!-- BOTTOM BAR: App title + date -->
                    <div class="px-6 py-3 flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="p-2 rounded-lg text-white" style="background:${loc.color}">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
                                </svg>
                            </div>
                            <div>
                                <h1 class="text-lg font-bold text-gray-900">Production Planning System</h1>
                                <p class="text-xs text-gray-400">Configure ‚Üí Design ‚Üí Plan ‚Üí Monitor</p>
                           </div>
                       </div>
                        <div class="flex items-center space-x-3">
                            <div class="text-right">
                                <div class="text-xs text-gray-400">Today</div>
                                <div class="text-sm font-bold text-gray-900">${APP_STATE.currentDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</div>
                            </div>
                            <button onclick="exportAllData()" class="text-white px-3 py-1.5 rounded-lg text-sm" style="background:${loc.color}">
                                üì• Export
                            </button>
                        </div>
                   </div>
               </div>
           `;
}

        function switchLocation(code) {
            if (!CEMEX_LOCATIONS[code]) return;
            APP_STATE.currentLocation = code;
            localStorage.setItem('cemex_current_location', code);
            renderApp();
        }

// ============================================
// NAVIGATION
// ============================================
